<% if locals[:summarize] %>
  <%= render "case_files/summarize", case_file: layering,
                                     content: JSON.parse(layering.content,
                                                symbolize_names: true) %>
<% else %>
  <div class = "span12">
  <script type="text/javascript" charset="utf-8">
  $(function() {
    new Highcharts.Chart({
      chart: {
         style: {
            fontFamily: 'monospace',
            color: "#f00"
        },
        renderTo: "events_chart", backgroundColor: null
      },
      title: {
        style: {
          color: "#FFF"
        },
        text: "Layering Events"
      },
      xAxis: {
        title: {
          text: "Time",
        },
        type: "datetime"
      },
      yAxis: {
        title: {
          text: "Price"
        }
      },
      credits: {
            enabled: false
      },
      series : [{
        name: "<%= @case_content[:participants] %> activity",
        pointInterval: <%= 1.second * 1000 %>,
        pointStart: <%= "1361955206000"[0..-4].to_i * 1000 %>,
        data: [1.0, 1.01, 1.02, 1.03, 1.04, 1.03, 1.02, 1.01, 1.00],
        marker: {
                lineWidth: 0,
                fillColor: '#FFF'
            }
      }]
    });
  });
</script>
<div id="events_chart" style="width:940px; height:425px;"></div>
  </div>
  <div class = "span12">
    <% if content.has_key?(:events) %>
    <div class="accordion" id="events">
      <div class="accordion-group">
        <div class="accordion-heading">
          <a class="accordion-toggle" data-toggle="collapse"
          data-parent="#events" href="#event_list" id="toggle"
          style="font-weight:bold">
            Hide Events
          </a>
        </div>
        <div id="event_list" class="accordion-body collapse in">
          <div class="accordion-inner">
            <table class="table table-bordered table-striped table-hover">
              <thead>
                <tr>
                  <th>Participant</th>
                  <th>Order State</th>
                  <th>Side</th>
                  <th>Size</th>
                  <th>Symbol</th>
                  <th>Price</th>
                  <th>Transact Time</th>
                  <th>Client Order Id</th>
                </tr>
              </thead>
              <tbody>
                <% content[:events].each do |o| %>
                  <tr>
                    <td><%= o[:participant] %></td>
                    <td><%= o[:status] %></td>
                    <td><%= o[:side] %></td>
                    <td><%= o[:size] %></td>          
                    <td><%= o[:symbol] %></td>
                    <td><%= o[:price] %></td>
                    <td><%= o[:transact_time] %></td>
                    <td><%= o[:client_order_id] %></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <% else %>
      <div class="well-small">
        <span style="color:red">No Events Found</span>
      </div>
    <% end %>
  </div>
<% end %>
